<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hi,Wei!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hi,Wei!">
<meta property="og:url" content="https:&#x2F;&#x2F;hiwei.top&#x2F;index.html">
<meta property="og:site_name" content="Hi,Wei!">
<meta property="og:locale" content="UTF-8">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hi,Wei!" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hi,Wei!</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hiwei.top"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-升级squid代理服务器至4-9-0" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/03/%E5%8D%87%E7%BA%A7squid%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%B34-9-0/" class="article-date">
  <time datetime="2020-01-03T03:35:55.000Z" itemprop="datePublished">2020-01-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8C%A8%E8%B8%A2%E6%B0%91%E5%B7%A5/">挨踢民工</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/03/%E5%8D%87%E7%BA%A7squid%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%B34-9-0/">升级squid代理服务器至4.9.0</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#升级squid代理服务至4.9</p>
<p>　　两台生产squid，在启明天镜进行漏洞扫描时报版本太低，在squid官网（<a href="http://www.squid-cache.org）" target="_blank" rel="noopener">www.squid-cache.org）</a> 查询发现现网squid 3.5系列已经不再更新，准备直接升级至4.9。<br>　　服务器为CentOS 6及7，编译安装时报错，查询官网Known issues得知squid 4系列要求使用C++ 11，也即是GCC 4.9+，而CentOS的yum源上GCC最高才4.8.5，所以还得先编译安装GCC（当前最新版本9.2）。</p>
<p>##安装GCC9.2<br>###1、先升级c++编译器的相关依赖包</p>
<blockquote>
<p>yum clean all<br> yum makecache<br> yum install -y glibc-headers gcc-c++</p>
</blockquote>
<p>###2、下载安装包并解压</p>
<blockquote>
<p>cd /usr/local/src<br> wget <a href="http://10.121.2.5:31280/source/gcc/gcc-9.2.0.tar" target="_blank" rel="noopener">http://10.121.2.5:31280/source/gcc/gcc-9.2.0.tar</a><br> tar -xvf gcc-9.2.0.tar</p>
</blockquote>
<p>###3、下载供编译需求的依赖项</p>
<blockquote>
<p>cd gcc-9.2.0<br> ./contrib/download_prerequisites<br>　　GCC官网建议执行./contrib/download_prerequisites这个脚本文件会帮我们下载、配置、安装依赖库，可以节约我们大量的时间和精力。但是下载速度太慢，所以我预先将gcc9.2.0对应的四个依赖包放进了上面的tar安装包里，只需要验证一下。</p>
</blockquote>
<p>###4、建立一个目录供编译出的文件存放</p>
<blockquote>
<p>mkdir gcc-build-6.1.0<br> cd gcc-build-6.1.0</p>
</blockquote>
<p>###5、生成Makefile文件</p>
<blockquote>
<p>../configure -enable-checking=release -enable-languages=c,c++ -disable-multilib</p>
</blockquote>
<p>###6、编译</p>
<blockquote>
<p>make<br>　　此步骤非常耗时，虚拟机耗时近3小时。如果出现 /lib/cpp fails sanity check 错误，是由于c++编译器的相关package没有安装，参考第１步。</p>
</blockquote>
<p>###7、安装</p>
<blockquote>
<p>make install<br>　　安装需要root权限！完成后查看安装情况:<br>ls /usr/local/bin | grep gcc<br> gcc -v</p>
</blockquote>
<p>###8、替换老版本gcc的动态库</p>
<blockquote>
<p>strings /usr/lib64/libstdc++.so.6 | grep GLIBC<br>　　从输出可以看出，gcc的动态库还是旧版本的。说明出现这些问题，是因为升级gcc时，生成的动态库没有替换老版本gcc的动态库。先找出编译gcc时生成的最新动态库：</p>
</blockquote>
<blockquote>
<p>find / -name “libstdc++.so*”<br>　　将上面的最新动态库libstdc++.so.6.0.27复制到/usr/lib64目录下，创建软连接并检查。这时已经可以看到GLIBC_2.6及GLIBCXX_3.4.27。<br>cd /usr/lib64<br> cp /usr/local/src/gcc-9.2.0/gcc-build/stage1-x86_64-pc-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6.0.27 .<br> rm -f libstdc++.so.6<br> ln -s libstdc++.so.6.0.27 libstdc++.so.6<br> strings /usr/lib64/libstdc++.so.6 | grep GLIBC</p>
</blockquote>
<p>###9、替换gcc可执行文件</p>
<blockquote>
<p>whereis gcc<br>cd /usr/bin<br>mv gcc gcc.4.4.7<br>ln -s /usr/local/bin/gcc /usr/bin/gcc</p>
</blockquote>
<p>##安装SQUID4.9</p>
<blockquote>
<p>cd /usr/local/src<br> wget <a href="http://10.121.2.5:31280/source/squid/squid-4.9.tar.gz" target="_blank" rel="noopener">http://10.121.2.5:31280/source/squid/squid-4.9.tar.gz</a><br> tar -zxvf squid-4.9.tar.gz<br> cd squid-4.9<br> ./configure ‘–prefix=/usr/local/squid-4.9.0’ <br>    ‘–with-included-ltdl’ <br>    ‘–enable-internal-dns’ <br>    ‘–disable-strict-error-checking’ <br>    ‘–disable-dependency-tracking’ <br>    ‘–enable-arp-acl’ <br>    ‘–enable-follow-x-forwarded-for’ <br>    ‘–enable-cache-digests’ <br>    ‘–enable-cachemgr-hostname=localhost’ <br>    ‘–enable-delay-pools’ <br>    ‘–enable-epoll’ <br>    ‘–enable-icap-client’ <br>    ‘–enable-ident-lookups’ <br>    ‘–enable-linux-netfilter’ <br>    ‘–enable-referer-log’ <br>    ‘–enable-removal-policies=heap,lru’ <br>    ‘–enable-ssl’ <br>    ‘–enable-useragent-log’ <br>    ‘–enable-wccpv2’ <br>    ‘–enable-esi’ <br>    ‘–enable-gnuregex’ <br>    ‘–enable-underscore’ <br>    ‘–disable-mempools’ <br>    ‘–enable-http-violations’ <br>    ‘–with-aio’ <br>    ‘–with-default-user=squid’ <br>    ‘–with-filedescriptors=65536’ <br>    ‘–with-dl’ <br>    ‘–with-openssl’ <br>    ‘–with-pthreads’<br> make &amp;&amp; make install</p>
</blockquote>
<p>　　最后将生产环境的配置文件复制过来，修改服务文件，启动服务进行验证。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hiwei.top/2020/01/03/%E5%8D%87%E7%BA%A7squid%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%B34-9-0/" data-id="ck4xrb54l0001ix3l3o22bet0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CISP培训认证" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/13/CISP%E5%9F%B9%E8%AE%AD%E8%AE%A4%E8%AF%81/" class="article-date">
  <time datetime="2019-12-13T03:36:04.000Z" itemprop="datePublished">2019-12-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8C%A8%E8%B8%A2%E6%B0%91%E5%B7%A5/">挨踢民工</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/13/CISP%E5%9F%B9%E8%AE%AD%E8%AE%A4%E8%AF%81/">CISP培训认证</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>　　作为信息安全服务合同的一部分，在广州参加了为期5天的CISP（注册信息安全人员）培训，周六进行了认证考试。总体感觉这是一个相关从业人员的上岗认证，难度不高、强度很大，自从学校毕业之后，没有经过这么高强度的学习了，白天听6个小时的讲课，晚上做6个小时的习题，400多页的课本要在5天内学完，中间还有超过一半是概念性的内容，需要死记硬背，苦啊。<br>　　收获也是比较大的，从技术上看，以前从网上学到的零星分散的知识点，经过比较系统的总结，都串了起来，还补充了一些缺漏的地方。从工程管理的角度，丰富了知识，了解到文档的重要性，很多错误观念得到了纠正。结合我们的实际工作，了解到不足，对未来工作的方向有了比较清晰的认识。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hiwei.top/2019/12/13/CISP%E5%9F%B9%E8%AE%AD%E8%AE%A4%E8%AF%81/" data-id="ck4xrb53k0000ix3l9s5jgm5p" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-第二次开张" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/13/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%BC%A0/" class="article-date">
  <time datetime="2019-11-13T08:20:06.000Z" itemprop="datePublished">2019-11-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/11/13/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%BC%A0/">第二次开张</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>　　博客第二次开张了。<br>　　这次自己在VirMach买了VPS安装nginx，在namesilo买了个域名hiwei.top，在he.net将这个域名解析到VPS上，并使用Let’s Encrypt签发了CA证书，这样就完成了客户端到我网站 <a href="https://hiwei.top">https://hiwei.top</a> 的https服务。<br>之后就跟上次建博客一样，先去github开通github pages，再用hexo建站，最后在我VPS的nginx上，将/根目录直接反向代理到github pages的网址。<br>　　于是开张啦。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hiwei.top/2019/11/13/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%BC%A0/" data-id="ck4xrb5570003ix3lbk5r4u95" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8C%A8%E8%B8%A2%E6%B0%91%E5%B7%A5/">挨踢民工</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/03/%E5%8D%87%E7%BA%A7squid%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%87%B34-9-0/">升级squid代理服务器至4.9.0</a>
          </li>
        
          <li>
            <a href="/2019/12/13/CISP%E5%9F%B9%E8%AE%AD%E8%AE%A4%E8%AF%81/">CISP培训认证</a>
          </li>
        
          <li>
            <a href="/2019/11/13/%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%BC%A0/">第二次开张</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Davis Wei<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
  <div class="goBack" onclick="window.scrollTo('0','0')"></div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>